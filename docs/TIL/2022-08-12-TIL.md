---
layout: post
title:  "2022-08-12 TIL"
date:   2022-08-12 09:00:00 +0900
categories: TIL
---
<span style="color:green">centos > server.xml, catalina.sh </span>
================================================================

![](/img/server.xml.png)

```sh
<!--  server.xml 의 root element, server의 shutdown port를 지정 함 -->
    <Server port="8006" shutdown="SHUTDOWN">
<!--  server는 1개 이상의  service를 가질 수 있지만, 보통은 server.xml을 분리해서 관리-->
    <Listener className="org.apache.catalina.startup.VersionLoggerListener" />
    <Listener className="org.apache.catalina.core.AprLifecycleListener" SSLEngine="on" />
    <Listener className="org.apache.catalina.core.JreMemoryLeakPreventionListener" />
    <Listener className="org.apache.catalina.mbeans.GlobalResourcesLifecycleListener" />
    <Listener className="org.apache.catalina.core.ThreadLocalLeakPreventionListener" />

    <GlobalNamingResources>
        <Resource name="UserDatabase" auth="Container"
                type="org.apache.catalina.UserDatabase"
                description="User database that can be updated and saved"
                factory="org.apache.catalina.users.MemoryUserDatabaseFactory"
        pathname="conf/tomcat-users.xml" />
    </GlobalNamingResources>

<!-- service는 독립적인 톰캣의 서비스 이다. -->
    <Service name="Catalina"> 

<!-- Connector 에는 HTTP와 AJP등이 있다. -->
        <Connector port="7000" protocol="HTTP/1.1"
                connectionTimeout="20000"
                redirectPort="8443" />
        <Connector port="8009" protocol="AJP/1.3" redirectPort="8443" />
<!-- Engine은 적절한 Host로 처리를 넘기는 역할을 한다. -->
        <Engine name="Catalina" defaultHost="localhost">

        <Realm className="org.apache.catalina.realm.LockOutRealm">
            <Realm className="org.apache.catalina.realm.UserDatabaseRealm"
                resourceName="UserDatabase"/>
        </Realm>
<!-- VirtualHost를 의미하며, name 속성으로 설정된 호스트명으로 웹 애플리케이션을 제공한다. -->
<!-- 하나의 톰캣 인스턴스에 여러개의 <Host>도 사용가능하나, 보통 톰캣 인스턴스당 1개의 <Host> 설정을 추천한다. -->
        <Host name="localhost"  appBase="webapps"
                unpackWARs="true" autoDeploy="true">
            <Context path="" docBase="ROOT" privileged="true"  reloadable="true" > </Context>
<!-- 요청을 처리하는 파이프라인 사이에 추가되어 특별한 처리를 수행하는 컴포넌트다. -->
            <Valve className="org.apache.catalina.valves.AccessLogValve" directory="logs"
                prefix="localhost_access_log" suffix=".txt"
                pattern="%h %l %u %t &quot;%r&quot; %s %b" />
        </Host>
        </Engine>
    </Service>
    </Server>
```



















